#include "InstructionMap.hpp"

map<string, Instruction *(*)(string, string)> instructionMap = {
    {"100010", &createMOV},
    {"1100011", &createMOV},
    {"1011", &createMOV},
    {"1010000", &createMOV},
    {"1010001", &createMOV},
    {"10001110", &createMOV},
    {"10001100", &createMOV},
    {"11111111", &checkConflictAll1},
    {"01010", &createPUSH},
    {"000", &createPUSH},
    {"000000", &createADD},
    {"100000", &checkConflictBit7},
    {"0000010", &createADD},
    {"100000", &checkConflictBit7},
    {"0001010", &createADC},
    {"1111111", &createINC},
    {"01000", &createINC},
    {"00110111", &createAAA},
    {"00100111", &createBAA},
    {"001010", &createSUB},
    {"100000", &checkConflictBit7},
    {"0010110", &createSUB},
    {"000110", &createSBB},
    {"100000", &checkConflictBit7},
    {"000111", &createSBB},
    {"1111111", &createDEC},
    {"01001", &createDEC},
    {"1111111", &createNEG},
    {"001111", &createCMP},
    {"100000", &checkConflictBit7},
    {"0011110", &createCMP},
    {"00111111", &createAAS},
    {"00101111", &createDAS},
    {"1111011", &checkConflictTestMulOthers},
    {"11010100", &createAAM},
    {"1111011", &checkConflictTestMulOthers},
    {"11010101", &createAAD},
    {"10011000", &createCBW},
    {"10011001", &createCWD},
    {"10001111", &createPOP},
    {"01011", &createPOP},
    {"000", &createPOP},
    {"1000011", &createXCHG},
    {"10010", &createXCHG},
    {"1110010", &createIN},
    {"1110110", &createIN},
    {"1110011", &createOUT},
    {"1110111", &createOUT},
    {"11010111", &createXLAT},
    {"10001101", &createLEA},
    {"11000101", &createLDS},
    {"11000100", &createLES},
    {"10011111", &createLAHF},
    {"10011110", &createSAHF},
    {"10011100", &createPUSHF},
    {"10011101", &createPOPF},
    {"1111011", &checkConflictTestMulOthers},
    {"110100", &createShift},
    {"001000", &createAND},
    {"1000000", &checkConflictBit7},
    {"0010010", &createAND},
    {"1000010", &createTEST},
    {"1111011", &checkConflictTestMulOthers},
    {"1010100", &createTEST},
    {"000010", &createOR},
    {"1000000", &checkConflictBit7},
    {"0000110", &createOR},
    {"001100", &createXOR},
    {"1000000", &checkConflictBit7},
    {"0011010", &createXOR},
    {"1111001", &createREP},
    {"1010010", &createMOVS},
    {"1010011", &createCMPS},
    {"1010111", &createSCAS},
    {"1010110", &createLODS},
    {"1010101", &createSTOS},
    {"11101000", &createCALL},
    {"11111111", &checkConflictAll1},
    {"10011010", &createCALL},
    {"11111111", &checkConflictAll1},
    {"11101001", &createJMP},
    {"11101011", &createJMP},
    {"11111111", &checkConflictAll1},
    {"11101010", &createJMP},
    {"11111111", &checkConflictAll1},
    {"11000011", &createRET},
    {"11000010", &createRET},
    {"11001011", &createRET},
    {"11001010", &createRET},
    {"01110100", &createJE},
    {"01111100", &createJL},
    {"01111110", &createJLE},
    {"01110010", &createJB},
    {"01110110", &createJBE},
    {"01111010", &createJP},
    {"01110000", &createJO},
    {"01111000", &createJS},
    {"01110101", &createJNE},
    {"01111101", &createJNL},
    {"01111111", &createJNLE},
    {"01110011", &createJNB},
    {"01110111", &createJNBE},
    {"01111011", &checkConflictTestMulOthers},
    {"01110001", &createJNO},
    {"01111001", &createJNS},
    {"11100010", &createLOOP},
    {"11100001", &createLOOPZ},
    {"11100000", &createLOOPNZ},
    {"11100011", &createJCXZ},
    {"11001101", &createINT},
    {"11001100", &createINT},
    {"11001110", &createINTO},
    {"11001111", &createIRET},
    {"11111000", &createCLC},  // CLC - Clear Carry
    {"11110101", &createCMC},  // CMC - Complement Carry
    {"11111001", &createSTC},  // STC - Set Carry
    {"11111100", &createCLD},  // CLD - Clear Direction
    {"11111101", &createSTD},  // STD - Set Direction
    {"11111010", &createCLI},  // CLI - Clear Interrupt
    {"11111011", &createSTI},  // STI - Set Interrupt
    {"11110100", &createHLT},  // HLT - Halt
    {"10011011", &createWAIT}, // WAIT - Wait
    {"11011", &createESC},     // ESC - Escape (to External Device)
    {"11110000", &createLOCK}  // LOCK - Bus Lock Prefix

};
